"use strict";(self.webpackChunkapi_rushstack_io=self.webpackChunkapi_rushstack_io||[]).push([[30617],{50158:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var a=n(46393);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=s(n),g=r,m=u["".concat(p,".").concat(g)]||u[g]||c[g]||l;return n?a.createElement(m,o(o({ref:t},d),{},{components:n})):a.createElement(m,o({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=g;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i[u]="string"==typeof e?e:r,o[1]=i;for(var s=2;s<l;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},17532:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>l,metadata:()=>i,toc:()=>s});var a=n(29122),r=(n(46393),n(50158));const l={hide_title:!0,custom_edit_url:null,pagination_prev:null,pagination_next:null},o=void 0,i={unversionedId:"pages/rush-lib.pnpmoptionsconfiguration",id:"pages/rush-lib.pnpmoptionsconfiguration",title:"rush-lib.pnpmoptionsconfiguration",description:"Home &gt; @microsoft/rush-lib &gt; PnpmOptionsConfiguration",source:"@site/docs/pages/rush-lib.pnpmoptionsconfiguration.md",sourceDirName:"pages",slug:"/pages/rush-lib.pnpmoptionsconfiguration",permalink:"/pages/rush-lib.pnpmoptionsconfiguration",draft:!1,editUrl:null,tags:[],version:"current",frontMatter:{hide_title:!0,custom_edit_url:null,pagination_prev:null,pagination_next:null},sidebar:"docsSidebar"},p={},s=[{value:"PnpmOptionsConfiguration class",id:"pnpmoptionsconfiguration-class",level:2},{value:"Remarks",id:"remarks",level:2},{value:"Properties",id:"properties",level:2},{value:"Methods",id:"methods",level:2}],d={toc:s},u="wrapper";function c(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/pages/"},"Home")," ",">"," ",(0,r.kt)("a",{parentName:"p",href:"/pages/rush-lib"},"@microsoft/rush-lib")," ",">"," ",(0,r.kt)("a",{parentName:"p",href:"/pages/rush-lib.pnpmoptionsconfiguration"},"PnpmOptionsConfiguration")),(0,r.kt)("h2",{id:"pnpmoptionsconfiguration-class"},"PnpmOptionsConfiguration class"),(0,r.kt)("p",null,'Options that are only used when the PNPM package manager is selected. Use this class to load "common/config/rush/pnpm-config.json" file, or, load json from "pnpmOptions" field in "rush.json" for legacy support.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Signature:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"export declare class PnpmOptionsConfiguration extends PackageManagerOptionsConfigurationBase \n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Extends:")," ",(0,r.kt)("a",{parentName:"p",href:"/pages/rush-lib.packagemanageroptionsconfigurationbase"},"PackageManagerOptionsConfigurationBase")),(0,r.kt)("h2",{id:"remarks"},"Remarks"),(0,r.kt)("p",null,"It is valid to define these options in rush.json even if the PNPM package manager is not being used."),(0,r.kt)("h2",{id:"properties"},"Properties"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Modifiers"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.globalalloweddeprecatedversions"},"globalAllowedDeprecatedVersions")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("code",null,"readonly")),(0,r.kt)("td",{parentName:"tr",align:null},"Record","<","string, string",">"," ","|"," undefined"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("p",null,"The ",(0,r.kt)("code",null,"globalAllowedDeprecatedVersions")," setting suppresses installation warnings for package versions that the NPM registry reports as being deprecated. This is useful if the deprecated package is an indirect dependency of an external package that has not released a fix. The settings are copied into the ",(0,r.kt)("code",null,"pnpm.allowedDeprecatedVersions")," field of the ",(0,r.kt)("code",null,"common/temp/package.json")," file that is generated by Rush during installation."),(0,r.kt)("p",null,"PNPM documentation: ",(0,r.kt)("a",{parentName:"td",href:"https://pnpm.io/package%5C_json%5C#pnpmalloweddeprecatedversions"},"https://pnpm.io/package\\_json\\#pnpmalloweddeprecatedversions")),(0,r.kt)("p",null,"If you are working to eliminate a deprecated version, it's better to specify ",(0,r.kt)("code",null,"allowedDeprecatedVersions")," in the package.json file for individual Rush projects."))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.globalneverbuiltdependencies"},"globalNeverBuiltDependencies")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("code",null,"readonly")),(0,r.kt)("td",{parentName:"tr",align:null},"string","[","]"," ","|"," undefined"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("p",null,"The ",(0,r.kt)("code",null,"globalNeverBuiltDependencies")," setting suppresses the ",(0,r.kt)("code",null,"preinstall"),", ",(0,r.kt)("code",null,"install"),", and ",(0,r.kt)("code",null,"postinstall"),' lifecycle events for the specified NPM dependencies. This is useful for scripts with poor practices such as downloading large binaries without retries or attempting to invoke OS tools such as a C++ compiler. (PNPM\'s terminology refers to these lifecycle events as "building" a package; it has nothing to do with build system operations such as ',(0,r.kt)("code",null,"rush build")," or ",(0,r.kt)("code",null,"rushx build"),".) The settings are copied into the ",(0,r.kt)("code",null,"pnpm.neverBuiltDependencies")," field of the ",(0,r.kt)("code",null,"common/temp/package.json")," file that is generated by Rush during installation."),(0,r.kt)("p",null,"PNPM documentation: ",(0,r.kt)("a",{parentName:"td",href:"https://pnpm.io/package%5C_json%5C#pnpmneverbuiltdependencies"},"https://pnpm.io/package\\_json\\#pnpmneverbuiltdependencies")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.globaloverrides"},"globalOverrides")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("code",null,"readonly")),(0,r.kt)("td",{parentName:"tr",align:null},"Record","<","string, string",">"," ","|"," undefined"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("p",null,'The "globalOverrides" setting provides a simple mechanism for overriding version selections for all dependencies of all projects in the monorepo workspace. The settings are copied into the ',(0,r.kt)("code",null,"pnpm.overrides")," field of the ",(0,r.kt)("code",null,"common/temp/package.json")," file that is generated by Rush during installation."),(0,r.kt)("p",null,"Order of precedence: ",(0,r.kt)("code",null,".pnpmfile.cjs")," has the highest precedence, followed by ",(0,r.kt)("code",null,"unsupportedPackageJsonSettings"),", ",(0,r.kt)("code",null,"globalPeerDependencyRules"),", ",(0,r.kt)("code",null,"globalPackageExtensions"),", and ",(0,r.kt)("code",null,"globalOverrides")," has lowest precedence."),(0,r.kt)("p",null,"PNPM documentation: ",(0,r.kt)("a",{parentName:"td",href:"https://pnpm.io/package%5C_json%5C#pnpmoverrides"},"https://pnpm.io/package\\_json\\#pnpmoverrides")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.globalpackageextensions"},"globalPackageExtensions")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("code",null,"readonly")),(0,r.kt)("td",{parentName:"tr",align:null},"Record","<","string, IPnpmPackageExtension",">"," ","|"," undefined"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("p",null,"The ",(0,r.kt)("code",null,"globalPackageExtension")," setting provides a way to patch arbitrary package.json fields for any PNPM dependency of the monorepo. The settings are copied into the ",(0,r.kt)("code",null,"pnpm.packageExtensions")," field of the ",(0,r.kt)("code",null,"common/temp/package.json")," file that is generated by Rush during installation. The ",(0,r.kt)("code",null,"globalPackageExtension")," setting has similar capabilities as ",(0,r.kt)("code",null,".pnpmfile.cjs")," but without the downsides of an executable script (nondeterminism, unreliable caching, performance concerns)."),(0,r.kt)("p",null,"Order of precedence: ",(0,r.kt)("code",null,".pnpmfile.cjs")," has the highest precedence, followed by ",(0,r.kt)("code",null,"unsupportedPackageJsonSettings"),", ",(0,r.kt)("code",null,"globalPeerDependencyRules"),", ",(0,r.kt)("code",null,"globalPackageExtensions"),", and ",(0,r.kt)("code",null,"globalOverrides")," has lowest precedence."),(0,r.kt)("p",null,"PNPM documentation: ",(0,r.kt)("a",{parentName:"td",href:"https://pnpm.io/package%5C_json%5C#pnpmpackageextensions"},"https://pnpm.io/package\\_json\\#pnpmpackageextensions")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.globalpatcheddependencies"},"globalPatchedDependencies")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("code",null,"readonly")),(0,r.kt)("td",{parentName:"tr",align:null},"Record","<","string, string",">"," ","|"," undefined"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("p",null,"(GENERATED BY RUSH-PNPM PATCH-COMMIT) When modifying this property, make sure you know what you are doing."),(0,r.kt)("p",null,"The ",(0,r.kt)("code",null,"globalPatchedDependencies")," is added/updated automatically when you run pnpm patch-commit command. It is a dictionary where the key should be the package name and exact version. The value should be a relative path to a patch file."),(0,r.kt)("p",null,"PNPM documentation: ",(0,r.kt)("a",{parentName:"td",href:"https://pnpm.io/package%5C_json%5C#pnpmpatcheddependencies"},"https://pnpm.io/package\\_json\\#pnpmpatcheddependencies")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.globalpeerdependencyrules"},"globalPeerDependencyRules")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("code",null,"readonly")),(0,r.kt)("td",{parentName:"tr",align:null},"IPnpmPeerDependencyRules ","|"," undefined"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("p",null,"The ",(0,r.kt)("code",null,"globalPeerDependencyRules")," setting provides various settings for suppressing validation errors that are reported during installation with ",(0,r.kt)("code",null,"strictPeerDependencies=true"),". The settings are copied into the ",(0,r.kt)("code",null,"pnpm.peerDependencyRules")," field of the ",(0,r.kt)("code",null,"common/temp/package.json")," file that is generated by Rush during installation."),(0,r.kt)("p",null,"Order of precedence: ",(0,r.kt)("code",null,".pnpmfile.cjs")," has the highest precedence, followed by ",(0,r.kt)("code",null,"unsupportedPackageJsonSettings"),", ",(0,r.kt)("code",null,"globalPeerDependencyRules"),", ",(0,r.kt)("code",null,"globalPackageExtensions"),", and ",(0,r.kt)("code",null,"globalOverrides")," has lowest precedence."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"td",href:"https://pnpm.io/package%5C_json%5C#pnpmpeerdependencyrules"},"https://pnpm.io/package\\_json\\#pnpmpeerdependencyrules")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.jsonfilename"},"jsonFilename")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("code",null,"readonly")),(0,r.kt)("td",{parentName:"tr",align:null},"string ","|"," undefined"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.pnpmstore"},"pnpmStore")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("code",null,"readonly")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmstoreoptions"},"PnpmStoreOptions")),(0,r.kt)("td",{parentName:"tr",align:null},"The method used to resolve the store used by PNPM.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.pnpmstorepath"},"pnpmStorePath")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("code",null,"readonly")),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("p",null,"The path for PNPM to use as the store directory."),(0,r.kt)("p",null,"Will be overridden by environment variable RUSH","_","PNPM","_","STORE","_","PATH"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.preventmanualshrinkwrapchanges"},"preventManualShrinkwrapChanges")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("code",null,"readonly")),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},"If true, then ",(0,r.kt)("code",null,"rush install")," will report an error if manual modifications were made to the PNPM shrinkwrap file without running ",(0,r.kt)("code",null,"rush update")," afterwards.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.strictpeerdependencies"},"strictPeerDependencies")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("code",null,"readonly")),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},'If true, then Rush will add the "--strict-peer-dependencies" option when invoking PNPM.')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.unsupportedpackagejsonsettings"},"unsupportedPackageJsonSettings")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("code",null,"readonly")),(0,r.kt)("td",{parentName:"tr",align:null},"unknown ","|"," undefined"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("p",null,"(USE AT YOUR OWN RISK) This is a free-form property bag that will be copied into the ",(0,r.kt)("code",null,"common/temp/package.json")," file that is generated by Rush during installation. This provides a way to experiment with new PNPM features. These settings will override any other Rush configuration associated with a given JSON field except for ",(0,r.kt)("code",null,".pnpmfile.cjs"),"."),(0,r.kt)("p",null,"USAGE OF THIS SETTING IS NOT SUPPORTED BY THE RUSH MAINTAINERS AND MAY CAUSE RUSH TO MALFUNCTION. If you encounter a missing PNPM setting that you believe should be supported, please create a GitHub issue or PR. Note that Rush does not aim to support every possible PNPM setting, but rather to promote a battle-tested installation strategy that is known to provide a good experience for large teams with lots of projects."))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.useworkspaces"},"useWorkspaces")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("code",null,"readonly")),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},"If true, then Rush will use the workspaces feature to install and link packages when invoking PNPM.")))),(0,r.kt)("h2",{id:"methods"},"Methods"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Method"),(0,r.kt)("th",{parentName:"tr",align:null},"Modifiers"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/pages/rush-lib.pnpmoptionsconfiguration.updateglobalpatcheddependencies"},"updateGlobalPatchedDependencies(patchedDependencies)")),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"Updates patchedDependencies field of the PNPM options in the common/config/rush/pnpm-config.json file.")))))}c.isMDXComponent=!0}}]);